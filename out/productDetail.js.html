<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: productDetail.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: productDetail.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>let details = {};
let songs = [];
let genres = [];

$(document).ready(function () {
    const _URL = new URL(location.href);
    const ID_PRODUCT = _URL.searchParams.get("id");

    getProductDetails(ID_PRODUCT);

});


/**
 * Executes a GET request to get details of a product.
 *
 * @author Mattia Matteini &lt;matteinimattia@gmail.com>
 * @param {String} idProduct string with the id of the product to be searched
 */
function getProductDetails(idProduct) {
    if (idProduct) {
        reqHelper.get("search", "productDetails", {
            "idProduct": idProduct,
        }, function (res) {
            if (res.success) {
                summary = res.data;
                details = summary[0][0];
                songs = summary[1];
                genres = summary[2];
                console.log(summary);
                console.log(details, songs, genres);
                displayProductDetails(details, songs, genres);
                $("#addToCart").click(function () {
                    addToCart(idProduct);
                });
            } else {
                console.error("An error occurred while searching the product details.");
            }
        });
    }
}

function addToCart(idProduct) {
    if (idProduct > 0) {
        reqHelper.post("cart", "addEntry", {
            idProduct: idProduct
        },
            function (data) {
                if (data.success) {
                    Swal.fire("", "prodotto aggiunto al carrello", "success");
                } else {
                    Swal.fire("", "Verifica la disponibilità del prodotto", "error");
                }
            }
        );
    }
}

/**
 * Fills the page with the product details.
 *
 * @author Mattia Matteini &lt;matteinimattia@gmail.com>
 * @param {Object} details object with the product details
 * @param {Array} genres array with the genres of the album
 * @param {Array} songs array with the songs of the album
 */
function displayProductDetails(details, songs, genres) {
    if (details) {
        $("main .album-img").attr("src", `public/img/products/${details.imgPath}`);
        $("main .name").text(details.name);
        $("main .product-description").text(details.productDescription);
        $("main .type").text(details.type == 0 ? "CD" : "Vinile");
        $("main .quantity").text(details.quantity);
        $("main .author").text(details.author);
        if (genres) {
            genres.forEach(function (genre, index) {
                $("main .genres").append(index > 0 ? ", " + genre.genre : genre.genre);
            });
        }
        $("main .price").text("€ " + details.price);
        $("main .album-duration").text(secondsToTime(details.albumDuration));
        $("main .album-description").text(details.albumDescription);
        if (songs) {
            songs.forEach(function (song) {
                const $song = $(`&lt;li>${song.name} &lt;em>[${secondsToTime(song.duration)}]&lt;/em>&lt;/li>`);
                $("main .track-list").append($song);
            });
        }
    }
}


/**
 * Function that convert seconds in human readable format.
 * @author Mattia Matteini &lt;matteinimattia@gmail.com>
 * @param {Number} seconds number of seconds to be converted
 * @returns {String} string with the converted time
 */
function secondsToTime(seconds) {
    let _hours = Math.floor(seconds / 3600);
    let _minutes = Math.floor((seconds - (_hours * 3600)) / 60);
    let _seconds = seconds - (_hours * 3600) - (_minutes * 60);
    return (_hours > 0 ? _hours + ":" : "") +
        (_minutes &lt; 10 &amp;&amp; _hours > 0 ? "0" + _minutes : _minutes) +
        ":" + (_seconds &lt; 10 ? "0" + _seconds : _seconds);
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="MyJWT.html">MyJWT</a></li><li><a href="RequestHelper.html">RequestHelper</a></li></ul><h3>Global</h3><ul><li><a href="global.html#changeOrderState">changeOrderState</a></li><li><a href="global.html#deleteCard">deleteCard</a></li><li><a href="global.html#deleteNotification">deleteNotification</a></li><li><a href="global.html#displayCards">displayCards</a></li><li><a href="global.html#displayNotifications">displayNotifications</a></li><li><a href="global.html#displayOrders">displayOrders</a></li><li><a href="global.html#displayProductDetails">displayProductDetails</a></li><li><a href="global.html#displayProducts">displayProducts</a></li><li><a href="global.html#getCards">getCards</a></li><li><a href="global.html#getCartEntries">getCartEntries</a></li><li><a href="global.html#getNotifications">getNotifications</a></li><li><a href="global.html#getOrders">getOrders</a></li><li><a href="global.html#getProductDetails">getProductDetails</a></li><li><a href="global.html#getTotalFromOrder">getTotalFromOrder</a></li><li><a href="global.html#makeUrl">makeUrl</a></li><li><a href="global.html#modifyEntryCartQuantity">modifyEntryCartQuantity</a></li><li><a href="global.html#searchProducts">searchProducts</a></li><li><a href="global.html#secondsToTime">secondsToTime</a></li><li><a href="global.html#setDefaultCard">setDefaultCard</a></li><li><a href="global.html#updateCartPreview">updateCartPreview</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Tue Jan 25 2022 11:00:44 GMT+0100 (Ora standard dell’Europa centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
